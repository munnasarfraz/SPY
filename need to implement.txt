import pandas as pd
from concurrent.futures import ThreadPoolExecutor
from multiprocessing import Queue, cpu_count, Process, Manager
from tqdm import tqdm
import multiprocessing as mp
import os
import time

SENTINEL = None
BATCH_SIZE = 4  # You can tune this

# Utility: Chunk list into batches
def chunk_list(lst, chunk_size):
    for i in range(0, len(lst), chunk_size):
        yield lst[i:i + chunk_size]

# Reader: reads a batch of files and puts them in the queue
def reader_batch_thread(csv_names, source1_map, source2_map, queue, read_pbar, overall_pbar):
    batch = []
    for csv_name in csv_names:
        zip1, file1 = source1_map[csv_name]
        zip2, file2 = source2_map[csv_name]
        df1 = read_csv_from_local_zip(zip1, file1)
        df2 = read_csv_from_local_zip(zip2, file2)
        batch.append((csv_name, file1, df1, df2))
        read_pbar.update(1)
        overall_pbar.update(1)
    queue.put(batch)

# Compare worker: processes a batch of files
def compare_worker(queue, output_list, compare_pbar, overall_pbar):
    while True:
        batch = queue.get()
        if batch is SENTINEL:
            break
        for csv_name, file1, df1, df2 in batch:
            start = time.time()
            print(f"[PID {os.getpid()}] Comparing: {csv_name}")
            diff_df, summary = compare_csvs(df1, df2, file1)
            print(f"[PID {os.getpid()}] Done {csv_name} in {time.time() - start:.2f}s")
            output_list.append((csv_name, diff_df, summary))
            compare_pbar.update(1)
            overall_pbar.update(1)

# Main function
def run_comparison():
    source1_zips = list_zip_files(source_1_prefix)
    source2_zips = list_zip_files(source_2_prefix)

    source1_csv_map = {}
    source2_csv_map = {}

    build_csv_to_zip_map(source1_zips, 'downloads/source1', source1_csv_map)
    build_csv_to_zip_map(source2_zips, 'downloads/source2', source2_csv_map)

    common_csvs = list(set(source1_csv_map.keys()) & set(source2_csv_map.keys()))
    missing_in_source2 = set(source1_csv_map.keys()) - set(source2_csv_map.keys())
    missing_in_source1 = set(source2_csv_map.keys()) - set(source1_csv_map.keys())

    all_diffs = []
    all_summaries = {}

    print(f"ðŸ”„ Reading and comparing {len(common_csvs)} CSV files in parallel (batch size: {BATCH_SIZE})...")

    queue = mp.Queue(maxsize=cpu_count() * 2)
    manager = Manager()
    output_list = manager.list()

    with tqdm(total=len(common_csvs), desc="Overall Progress", ncols=100) as overall_pbar, \
         tqdm(total=len(common_csvs), desc="Reading Progress", ncols=100) as read_pbar, \
         tqdm(total=len(common_csvs), desc="Comparing Progress", ncols=100) as compare_pbar:

        # Start comparison processes
        num_workers = cpu_count()
        processes = []
        for _ in range(num_workers):
            p = Process(target=compare_worker, args=(queue, output_list, compare_pbar, overall_pbar))
            p.start()
            processes.append(p)

        # Start reader threads (with batching)
        with ThreadPoolExecutor(max_workers=32) as executor:
            futures = [
                executor.submit(
                    reader_batch_thread,
                    chunk,
                    source1_csv_map,
                    source2_csv_map,
                    queue,
                    read_pbar,
                    overall_pbar
                )
                for chunk in chunk_list(common_csvs, BATCH_SIZE)
            ]
            for future in futures:
                future.result()

        # Send sentinels to end workers
        for _ in range(num_workers):
            queue.put(SENTINEL)

        for p in processes:
            p.join()

    # Collect results
    for csv_name, diff_df, summary in output_list:
        if not diff_df.empty:
            diff_df['File'] = csv_name
            all_diffs.append(diff_df)
        all_summaries[csv_name] = summary

    if missing_in_source2:
        all_summaries["Missing CSVs in Source2"] = list(missing_in_source2)
    if missing_in_source1:
        all_summaries["Extra CSVs in Source2"] = list(missing_in_source1)

    final_diff_df = pd.concat(all_diffs) if all_diffs else pd.DataFrame()
    list_files = [len(source1_csv_map.keys()), len(source2_csv_map.keys())]
    return final_diff_df, all_summaries, list_files



>>>>>>>>>>>>>>>>>>>>>>>>>>>
[datetime.timedelta(microseconds=673372), datetime.timedelta(microseconds=230914), datetime.timedelta(microseconds=166309), datetime.timedelta(microseconds=238115), datetime.timedelta(microseconds=279104), datetime.timedelta(microseconds=374589), datetime.timedelta(microseconds=541478), datetime.timedelta(microseconds=473214), datetime.timedelta(microseconds=393531), datetime.timedelta(microseconds=524773), datetime.timedelta(microseconds=223251), datetime.timedelta(microseconds=488141), datetime.timedelta(microseconds=494392), datetime.timedelta(microseconds=368787), datetime.timedelta(microseconds=455983), datetime.timedelta(microseconds=398008), datetime.timedelta(microseconds=577945), datetime.timedelta(microseconds=568732), datetime.timedelta(microseconds=569366), datetime.timedelta(microseconds=682358), datetime.timedelta(microseconds=424570), datetime.timedelta(microseconds=437701), datetime.timedelta(microseconds=468291), datetime.timedelta(microseconds=480817), datetime.timedelta(microseconds=603043), datetime.timedelta(microseconds=603947), datetime.timedelta(microseconds=266084), datetime.timedelta(microseconds=316051), datetime.timedelta(microseconds=770071), datetime.timedelta(microseconds=670729), datetime.timedelta(microseconds=568489), datetime.timedelta(microseconds=505307), datetime.timedelta(microseconds=456321), datetime.timedelta(microseconds=225247), datetime.timedelta(microseconds=285698), datetime.timedelta(microseconds=388688), datetime.timedelta(microseconds=753264), datetime.timedelta(microseconds=760374), datetime.timedelta(microseconds=544208), datetime.timedelta(microseconds=442582), datetime.timedelta(microseconds=405875), datetime.timedelta(microseconds=425849), datetime.timedelta(microseconds=496270), datetime.timedelta(microseconds=248210), datetime.timedelta(microseconds=634592), datetime.timedelta(microseconds=259588), datetime.timedelta(microseconds=451968), datetime.timedelta(microseconds=483979), datetime.timedelta(microseconds=553586), datetime.timedelta(microseconds=549487), datetime.timedelta(microseconds=535356), datetime.timedelta(microseconds=227211), datetime.timedelta(microseconds=466950), datetime.timedelta(microseconds=666865), datetime.timedelta(microseconds=531977), datetime.timedelta(microseconds=458054), datetime.timedelta(microseconds=610460), datetime.timedelta(microseconds=634167), datetime.timedelta(microseconds=583959), datetime.timedelta(microseconds=468453), datetime.timedelta(microseconds=262503), datetime.timedelta(microseconds=353166), datetime.timedelta(microseconds=437157), datetime.timedelta(microseconds=189527), datetime.timedelta(microseconds=383579), datetime.timedelta(microseconds=626109), datetime.timedelta(microseconds=601782), datetime.timedelta(microseconds=431328), datetime.timedelta(microseconds=558907), datetime.timedelta(microseconds=597683), datetime.timedelta(microseconds=430140), datetime.timedelta(microseconds=248707), datetime.timedelta(microseconds=284300), datetime.timedelta(seconds=3, microseconds=957632), datetime.timedelta(seconds=3, microseconds=67658), datetime.timedelta(microseconds=519866), datetime.timedelta(microseconds=379722), datetime.timedelta(microseconds=566091), datetime.timedelta(microseconds=475869), datetime.timedelta(microseconds=509907), datetime.timedelta(microseconds=228252), datetime.timedelta(microseconds=390879), datetime.timedelta(microseconds=416547), datetime.timedelta(microseconds=235003), datetime.timedelta(microseconds=510905), datetime.timedelta(microseconds=712809), datetime.timedelta(microseconds=594963), datetime.timedelta(microseconds=645259), datetime.timedelta(microseconds=611879), datetime.timedelta(microseconds=196563), datetime.timedelta(microseconds=369226), datetime.timedelta(microseconds=472778), datetime.timedelta(microseconds=447604), datetime.timedelta(seconds=6, microseconds=607467), datetime.timedelta(microseconds=412156), datetime.timedelta(microseconds=385019), datetime.timedelta(microseconds=434152), datetime.timedelta(microseconds=540004), datetime.timedelta(microseconds=481513), datetime.timedelta(microseconds=384392), datetime.timedelta(microseconds=455383), datetime.timedelta(microseconds=426902), datetime.timedelta(microseconds=424706), datetime.timedelta(microseconds=273938), datetime.timedelta(microseconds=615354), datetime.timedelta(microseconds=543709), datetime.timedelta(microseconds=714728), datetime.timedelta(microseconds=302746), datetime.timedelta(microseconds=505014), datetime.timedelta(microseconds=447155), datetime.timedelta(microseconds=491390), datetime.timedelta(microseconds=709058), datetime.timedelta(microseconds=491522), datetime.timedelta(microseconds=456274), datetime.timedelta(microseconds=339987), datetime.timedelta(microseconds=617419), datetime.timedelta(seconds=9, microseconds=776563), datetime.timedelta(microseconds=329645), datetime.timedelta(microseconds=198236), datetime.timedelta(microseconds=394386), datetime.timedelta(microseconds=679743), datetime.timedelta(microseconds=598149), datetime.timedelta(microseconds=853404), datetime.timedelta(seconds=3, microseconds=925373), datetime.timedelta(microseconds=326488), datetime.timedelta(microseconds=259126), datetime.timedelta(microseconds=405319), datetime.timedelta(microseconds=608439), datetime.timedelta(microseconds=325134), datetime.timedelta(microseconds=311851), datetime.timedelta(microseconds=440911), datetime.timedelta(seconds=10, microseconds=310753), datetime.timedelta(microseconds=570379), datetime.timedelta(microseconds=383019), datetime.timedelta(microseconds=718035), datetime.timedelta(seconds=2, microseconds=614013), datetime.timedelta(microseconds=532685), datetime.timedelta(microseconds=715443), datetime.timedelta(microseconds=380553), datetime.timedelta(microseconds=210149), datetime.timedelta(microseconds=213285), datetime.timedelta(seconds=1, microseconds=902828), datetime.timedelta(microseconds=222722), datetime.timedelta(microseconds=247249), datetime.timedelta(microseconds=455752), datetime.timedelta(seconds=2, microseconds=13927), datetime.timedelta(microseconds=675662), datetime.timedelta(microseconds=664418), datetime.timedelta(microseconds=463884), datetime.timedelta(microseconds=118509), datetime.timedelta(microseconds=523019), datetime.timedelta(microseconds=526898), datetime.timedelta(microseconds=265131), datetime.timedelta(microseconds=621492), datetime.timedelta(microseconds=642181), datetime.timedelta(microseconds=437606), datetime.timedelta(microseconds=353226), datetime.timedelta(microseconds=607224), datetime.timedelta(seconds=9, microseconds=860115), datetime.timedelta(microseconds=663079), datetime.timedelta(microseconds=531392), datetime.timedelta(microseconds=502483), datetime.timedelta(microseconds=329238), datetime.timedelta(microseconds=729012), datetime.timedelta(microseconds=493119), datetime.timedelta(microseconds=368286), datetime.timedelta(microseconds=361604), datetime.timedelta(microseconds=698474), datetime.timedelta(microseconds=408330), datetime.timedelta(microseconds=339148), datetime.timedelta(microseconds=418644), datetime.timedelta(microseconds=325048), datetime.timedelta(microseconds=486532), datetime.timedelta(microseconds=310812), datetime.timedelta(microseconds=567826), datetime.timedelta(microseconds=298960), datetime.timedelta(microseconds=347237), datetime.timedelta(seconds=4, microseconds=50363), datetime.timedelta(microseconds=436691), datetime.timedelta(microseconds=534469), datetime.timedelta(microseconds=281476), datetime.timedelta(microseconds=192169), datetime.timedelta(microseconds=228457), datetime.timedelta(microseconds=278725), datetime.timedelta(microseconds=451617), datetime.timedelta(microseconds=514298), datetime.timedelta(microseconds=506281), datetime.timedelta(microseconds=533127), datetime.timedelta(microseconds=447086), datetime.timedelta(microseconds=442105), datetime.timedelta(microseconds=522114), datetime.timedelta(microseconds=470355), datetime.timedelta(microseconds=691301), datetime.timedelta(microseconds=373298), datetime.timedelta(microseconds=448779), datetime.timedelta(microseconds=382706), datetime.timedelta(microseconds=198892), datetime.timedelta(microseconds=249235), datetime.timedelta(microseconds=450633), datetime.timedelta(microseconds=538827), datetime.timedelta(microseconds=410990), datetime.timedelta(microseconds=637939), datetime.timedelta(microseconds=419206), datetime.timedelta(microseconds=510442), datetime.timedelta(microseconds=463804), datetime.timedelta(microseconds=374036), datetime.timedelta(microseconds=715311), datetime.timedelta(microseconds=341338), datetime.timedelta(microseconds=414318), datetime.timedelta(microseconds=486973), datetime.timedelta(microseconds=394404), datetime.timedelta(microseconds=382529), datetime.timedelta(microseconds=306738), datetime.timedelta(microseconds=521597), datetime.timedelta(microseconds=415477), datetime.timedelta(microseconds=339004), datetime.timedelta(microseconds=510236), datetime.timedelta(microseconds=628845), datetime.timedelta(microseconds=430819), datetime.timedelta(microseconds=488498), datetime.timedelta(microseconds=566408), datetime.timedelta(microseconds=626950), datetime.timedelta(microseconds=436176), datetime.timedelta(microseconds=590702), datetime.timedelta(microseconds=603398), datetime.timedelta(microseconds=380482), datetime.timedelta(microseconds=383950), datetime.timedelta(microseconds=201233), datetime.timedelta(microseconds=571267), datetime.timedelta(microseconds=392553), datetime.timedelta(microseconds=383196), datetime.timedelta(microseconds=585550), datetime.timedelta(microseconds=555828), datetime.timedelta(microseconds=330694), datetime.timedelta(microseconds=608437), datetime.timedelta(microseconds=258653), datetime.timedelta(microseconds=803158), datetime.timedelta(microseconds=457709), datetime.timedelta(microseconds=819977), datetime.timedelta(microseconds=487581), datetime.timedelta(microseconds=694752), datetime.timedelta(microseconds=421128), datetime.timedelta(microseconds=488613), datetime.timedelta(microseconds=471505), datetime.timedelta(microseconds=517452), datetime.timedelta(microseconds=490502), datetime.timedelta(microseconds=665291), datetime.timedelta(microseconds=552574), datetime.timedelta(microseconds=797435), datetime.timedelta(microseconds=507019), datetime.timedelta(microseconds=587849), datetime.timedelta(microseconds=210021), datetime.timedelta(microseconds=610775), datetime.timedelta(microseconds=100761), datetime.timedelta(microseconds=612097), datetime.timedelta(microseconds=646345), datetime.timedelta(microseconds=511308), datetime.timedelta(microseconds=507223), datetime.timedelta(microseconds=549524), datetime.timedelta(microseconds=887370), datetime.timedelta(microseconds=520522), datetime.timedelta(microseconds=694970), datetime.timedelta(microseconds=523523), datetime.timedelta(microseconds=608348), datetime.timedelta(microseconds=589585), datetime.timedelta(seconds=1, microseconds=331937), datetime.timedelta(microseconds=330879), datetime.timedelta(microseconds=360493), datetime.timedelta(microseconds=329608), datetime.timedelta(microseconds=457269), datetime.timedelta(microseconds=458732), datetime.timedelta(microseconds=638247), datetime.timedelta(microseconds=752207), datetime.timedelta(microseconds=428281), datetime.timedelta(microseconds=305685), datetime.timedelta(microseconds=430235), datetime.timedelta(microseconds=380629), datetime.timedelta(microseconds=370813), datetime.timedelta(microseconds=355595), datetime.timedelta(microseconds=482948), datetime.timedelta(microseconds=500725), datetime.timedelta(microseconds=320447), datetime.timedelta(microseconds=561325), datetime.timedelta(microseconds=684712), datetime.timedelta(microseconds=578267), datetime.timedelta(microseconds=627891), datetime.timedelta(microseconds=284275), datetime.timedelta(microseconds=299210), datetime.timedelta(microseconds=278574), datetime.timedelta(microseconds=415806), datetime.timedelta(microseconds=360129), datetime.timedelta(microseconds=172043), datetime.timedelta(microseconds=496942), datetime.timedelta(microseconds=468038), datetime.timedelta(microseconds=225754), datetime.timedelta(microseconds=359181), datetime.timedelta(microseconds=231957), datetime.timedelta(microseconds=272177), datetime.timedelta(microseconds=170972), datetime.timedelta(microseconds=138247), datetime.timedelta(microseconds=229356), datetime.timedelta(microseconds=322735), datetime.timedelta(microseconds=259719), datetime.timedelta(microseconds=380649), datetime.timedelta(microseconds=277836), datetime.timedelta(microseconds=315299), datetime.timedelta(microseconds=362399), datetime.timedelta(microseconds=263611), datetime.timedelta(seconds=2, microseconds=832125), datetime.timedelta(microseconds=314868), datetime.timedelta(microseconds=166392), datetime.timedelta(microseconds=172851), datetime.timedelta(microseconds=261627), datetime.timedelta(microseconds=287429), datetime.timedelta(microseconds=189173), datetime.timedelta(microseconds=370281), datetime.timedelta(seconds=7, microseconds=446886), datetime.timedelta(seconds=29, microseconds=360306), datetime.timedelta(microseconds=425661), datetime.timedelta(microseconds=429226), datetime.timedelta(microseconds=188115), datetime.timedelta(microseconds=455928), datetime.timedelta(microseconds=402413), datetime.timedelta(microseconds=363442), datetime.timedelta(microseconds=298021), datetime.timedelta(microseconds=264873), datetime.timedelta(microseconds=223683), datetime.timedelta(microseconds=186950), datetime.timedelta(microseconds=240607), datetime.timedelta(microseconds=231425), datetime.timedelta(microseconds=325734), datetime.timedelta(microseconds=240814), datetime.timedelta(seconds=12, microseconds=994325), datetime.timedelta(microseconds=218795), datetime.timedelta(microseconds=291608), datetime.timedelta(microseconds=222262), datetime.timedelta(microseconds=435954), datetime.timedelta(microseconds=411208), datetime.timedelta(microseconds=310991), datetime.timedelta(microseconds=317527), datetime.timedelta(microseconds=406307), datetime.timedelta(microseconds=359841), datetime.timedelta(microseconds=398319), datetime.timedelta(microseconds=316231), datetime.timedelta(microseconds=537100), datetime.timedelta(microseconds=330301), datetime.timedelta(microseconds=371176), datetime.timedelta(microseconds=380590), datetime.timedelta(microseconds=241694), datetime.timedelta(microseconds=290435), datetime.timedelta(microseconds=231540), datetime.timedelta(microseconds=267603), datetime.timedelta(microseconds=315545), datetime.timedelta(microseconds=237634), datetime.timedelta(microseconds=471195), datetime.timedelta(microseconds=489445), datetime.timedelta(microseconds=543227), datetime.timedelta(microseconds=410873), datetime.timedelta(microseconds=199419), datetime.timedelta(microseconds=391041), datetime.timedelta(microseconds=405888), datetime.timedelta(microseconds=434001), datetime.timedelta(microseconds=449207), datetime.timedelta(microseconds=489096), datetime.timedelta(microseconds=653795), datetime.timedelta(microseconds=314262), datetime.timedelta(microseconds=242304), datetime.timedelta(microseconds=280273), datetime.timedelta(microseconds=575711), datetime.timedelta(microseconds=488447), datetime.timedelta(microseconds=261183), datetime.timedelta(microseconds=465359), datetime.timedelta(microseconds=303662), datetime.timedelta(microseconds=203959), datetime.timedelta(microseconds=265425), datetime.timedelta(microseconds=171552), datetime.timedelta(microseconds=414135), datetime.timedelta(microseconds=444855), datetime.timedelta(microseconds=193316), datetime.timedelta(microseconds=196737), datetime.timedelta(microseconds=343546), datetime.timedelta(microseconds=287575), datetime.timedelta(microseconds=257901), datetime.timedelta(microseconds=294978), datetime.timedelta(microseconds=325313), datetime.timedelta(microseconds=500044), datetime.timedelta(microseconds=360294), datetime.timedelta(microseconds=242862), datetime.timedelta(microseconds=337314), datetime.timedelta(microseconds=320160), datetime.timedelta(microseconds=241768), datetime.timedelta(microseconds=255888), datetime.timedelta(microseconds=504704), datetime.timedelta(microseconds=513886), datetime.timedelta(microseconds=311939), datetime.timedelta(seconds=19, microseconds=829381), datetime.timedelta(microseconds=214290), datetime.timedelta(microseconds=285779), datetime.timedelta(microseconds=292216), datetime.timedelta(microseconds=219729), datetime.timedelta(microseconds=280602), datetime.timedelta(microseconds=303010), datetime.timedelta(microseconds=202618), datetime.timedelta(microseconds=122663), datetime.timedelta(microseconds=209161), datetime.timedelta(microseconds=154819), datetime.timedelta(microseconds=158227), datetime.timedelta(microseconds=337022), datetime.timedelta(microseconds=254207), datetime.timedelta(microseconds=266966), datetime.timedelta(microseconds=170667), datetime.timedelta(microseconds=154606), datetime.timedelta(seconds=21, microseconds=625795), datetime.timedelta(microseconds=382648), datetime.timedelta(microseconds=212469), datetime.timedelta(seconds=4, microseconds=450060), datetime.timedelta(microseconds=360307), datetime.timedelta(microseconds=268406), datetime.timedelta(microseconds=227394), datetime.timedelta(microseconds=233141), datetime.timedelta(microseconds=335822), datetime.timedelta(microseconds=216164), datetime.timedelta(microseconds=172282), datetime.timedelta(microseconds=206795), datetime.timedelta(microseconds=212098), datetime.timedelta(microseconds=249441), datetime.timedelta(microseconds=271220), datetime.timedelta(microseconds=106103), datetime.timedelta(microseconds=94219), datetime.timedelta(microseconds=318507), datetime.timedelta(microseconds=200820), datetime.timedelta(microseconds=382725), datetime.timedelta(microseconds=80985), datetime.timedelta(microseconds=99036), datetime.timedelta(microseconds=197265), datetime.timedelta(microseconds=178341), datetime.timedelta(microseconds=346467), datetime.timedelta(microseconds=129958), datetime.timedelta(seconds=5, microseconds=515053), datetime.timedelta(seconds=5, microseconds=219238), datetime.timedelta(microseconds=266048), datetime.timedelta(microseconds=223852), datetime.timedelta(microseconds=232770), datetime.timedelta(microseconds=320344), datetime.timedelta(microseconds=358099), datetime.timedelta(microseconds=133787), datetime.timedelta(microseconds=175562), datetime.timedelta(microseconds=244279), datetime.timedelta(microseconds=219296), datetime.timedelta(microseconds=147899), datetime.timedelta(microseconds=164672), datetime.timedelta(microseconds=110775), datetime.timedelta(microseconds=219121), datetime.timedelta(microseconds=353554), datetime.timedelta(microseconds=425051), datetime.timedelta(microseconds=220398), datetime.timedelta(microseconds=267297), datetime.timedelta(microseconds=214493), datetime.timedelta(microseconds=134199), datetime.timedelta(microseconds=286925), datetime.timedelta(microseconds=218896), datetime.timedelta(microseconds=154827), datetime.timedelta(microseconds=112627), datetime.timedelta(microseconds=70160), datetime.timedelta(microseconds=163002), datetime.timedelta(microseconds=153973), datetime.timedelta(microseconds=129149), datetime.timedelta(microseconds=237664), datetime.timedelta(seconds=25, microseconds=279338), datetime.timedelta(microseconds=205754), datetime.timedelta(microseconds=326462), datetime.timedelta(microseconds=202874), datetime.timedelta(microseconds=309409), datetime.timedelta(microseconds=304822), datetime.timedelta(microseconds=446539), datetime.timedelta(microseconds=222489), datetime.timedelta(microseconds=246104), datetime.timedelta(microseconds=341969), datetime.timedelta(microseconds=336791), datetime.timedelta(microseconds=181700), datetime.timedelta(microseconds=166574), datetime.timedelta(microseconds=216491), datetime.timedelta(microseconds=186563), datetime.timedelta(microseconds=199104), datetime.timedelta(microseconds=171811), datetime.timedelta(microseconds=142172), datetime.timedelta(microseconds=93717), datetime.timedelta(microseconds=268509), datetime.timedelta(microseconds=191073), datetime.timedelta(microseconds=268761), datetime.timedelta(microseconds=212331), datetime.timedelta(microseconds=217428), datetime.timedelta(microseconds=119003), datetime.timedelta(microseconds=213361), datetime.timedelta(microseconds=155444), datetime.timedelta(microseconds=279107), datetime.timedelta(microseconds=515114), datetime.timedelta(microseconds=158948), datetime.timedelta(microseconds=128867), datetime.timedelta(microseconds=137456), datetime.timedelta(microseconds=203548), datetime.timedelta(microseconds=273975), datetime.timedelta(microseconds=113414), datetime.timedelta(microseconds=55290), datetime.timedelta(microseconds=88804), datetime.timedelta(microseconds=177179), datetime.timedelta(microseconds=244066), datetime.timedelta(microseconds=226339), datetime.timedelta(seconds=1, microseconds=93762), datetime.timedelta(microseconds=130004), datetime.timedelta(microseconds=133471), datetime.timedelta(microseconds=245046), datetime.timedelta(microseconds=231923), datetime.timedelta(microseconds=193468), datetime.timedelta(microseconds=146795), datetime.timedelta(microseconds=90130), datetime.timedelta(microseconds=120389), datetime.timedelta(microseconds=135979), datetime.timedelta(microseconds=118875), datetime.timedelta(microseconds=154910), datetime.timedelta(microseconds=113167), datetime.timedelta(microseconds=147076), datetime.timedelta(microseconds=76547), datetime.timedelta(microseconds=82096), datetime.timedelta(microseconds=85271), datetime.timedelta(microseconds=240579), datetime.timedelta(microseconds=235270), datetime.timedelta(microseconds=79305), datetime.timedelta(microseconds=156456), datetime.timedelta(microseconds=118669), datetime.timedelta(microseconds=121345), datetime.timedelta(microseconds=125652), datetime.timedelta(seconds=3, microseconds=167004), datetime.timedelta(microseconds=107919), datetime.timedelta(microseconds=189550), datetime.timedelta(microseconds=151042), datetime.timedelta(microseconds=98057), datetime.timedelta(seconds=4, microseconds=248796), datetime.timedelta(microseconds=250106), datetime.timedelta(microseconds=190441), datetime.timedelta(microseconds=174918), datetime.timedelta(microseconds=158790), datetime.timedelta(microseconds=133031), datetime.timedelta(microseconds=291703), datetime.timedelta(seconds=22, microseconds=874911), datetime.timedelta(microseconds=108292), datetime.timedelta(microseconds=157428), datetime.timedelta(microseconds=138681), datetime.timedelta(microseconds=145472), datetime.timedelta(microseconds=111797), datetime.timedelta(microseconds=116159), datetime.timedelta(microseconds=73546), datetime.timedelta(microseconds=238699), datetime.timedelta(microseconds=105376), datetime.timedelta(microseconds=129645), datetime.timedelta(seconds=30, microseconds=737350), datetime.timedelta(seconds=20, microseconds=763396), datetime.timedelta(microseconds=166004), datetime.timedelta(microseconds=204282), datetime.timedelta(microseconds=219081), datetime.timedelta(microseconds=82989), datetime.timedelta(microseconds=132640), datetime.timedelta(microseconds=674105), datetime.timedelta(microseconds=199462), datetime.timedelta(microseconds=152947), datetime.timedelta(microseconds=240545), datetime.timedelta(microseconds=208134), datetime.timedelta(microseconds=184898), datetime.timedelta(seconds=25, microseconds=724072), datetime.timedelta(microseconds=235216), datetime.timedelta(microseconds=227661), datetime.timedelta(microseconds=245731), datetime.timedelta(microseconds=146146), datetime.timedelta(microseconds=228022), datetime.timedelta(microseconds=174292), datetime.timedelta(seconds=14, microseconds=144044), datetime.timedelta(microseconds=255638), datetime.timedelta(microseconds=184788), datetime.timedelta(microseconds=264057), datetime.timedelta(seconds=14, microseconds=303120), datetime.timedelta(microseconds=301734), datetime.timedelta(microseconds=339147), datetime.timedelta(microseconds=246643), datetime.timedelta(microseconds=344514), datetime.timedelta(microseconds=291894), datetime.timedelta(seconds=1, microseconds=460609), datetime.timedelta(microseconds=156877), datetime.timedelta(microseconds=410080), datetime.timedelta(microseconds=293473), datetime.timedelta(microseconds=159079), datetime.timedelta(microseconds=270361), datetime.timedelta(microseconds=284100), datetime.timedelta(microseconds=339970), datetime.timedelta(microseconds=307426), datetime.timedelta(microseconds=363949), datetime.timedelta(microseconds=261694), datetime.timedelta(microseconds=312777), datetime.timedelta(microseconds=293093), datetime.timedelta(microseconds=371728), datetime.timedelta(microseconds=400407), datetime.timedelta(microseconds=301906), datetime.timedelta(microseconds=358205), datetime.timedelta(seconds=34, microseconds=507719), datetime.timedelta(microseconds=203107), datetime.timedelta(seconds=11, microseconds=469925), datetime.timedelta(microseconds=237916), datetime.timedelta(microseconds=524763), datetime.timedelta(seconds=35, microseconds=615205), datetime.timedelta(microseconds=555672), datetime.timedelta(microseconds=258178), datetime.timedelta(seconds=2, microseconds=116122), datetime.timedelta(microseconds=409675), datetime.timedelta(microseconds=210393), datetime.timedelta(microseconds=281799), datetime.timedelta(microseconds=236644), datetime.timedelta(microseconds=243991), datetime.timedelta(microseconds=228658), datetime.timedelta(microseconds=236276), datetime.timedelta(microseconds=178428), datetime.timedelta(microseconds=153130), datetime.timedelta(microseconds=122946), datetime.timedelta(microseconds=256143), datetime.timedelta(microseconds=194336), datetime.timedelta(microseconds=220473), datetime.timedelta(microseconds=177410), datetime.timedelta(microseconds=190712), datetime.timedelta(seconds=42, microseconds=841468), datetime.timedelta(microseconds=53305), datetime.timedelta(seconds=9, microseconds=326924)]
